<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Step 2 YOOOOOOOOOOOOOOOOOOOOOOOOOOOO</title>
  </head>
  <body>
    <form id="search-form" onsubmit="return false">
      <input type="text" name="search">
      <input type="submit" name="search" value="search" onclick="searchSubmit()">
    </form>
    <br>
    <table width = "100%">
      <thead>
        <tr style="text-align:left;">
          <th width="40%">Title</th>
          <th width="30%">Author</th>
          <th width="10%">Year</th>
          <th width="20%">ID</th>
        </tr>
      </thead>
      <tbody id="search-result">
      </tbody>
    </table>



    <script type="text/javascript" src="https://code.jquery.com/jquery-3.4.1.js"></script>
    <script type="text/javascript">
            function searchSubmit() {
              $.ajax({
                url: "/search",
                method: "POST",
                data: $("#search-form").serialize(),
                success: function(rawData){
                  var parsed = JSON.parse(rawData);

                  if(!parsed) return

                  var resultTable = $("#search-result");
                  resultTable.empty();

                  parsed.forEach(function(result){
                    var row = $("<tr><td>" + result.Title + "</td><td>" + result.Author + "</td><td>" + result.Year + "</td><td>" + result.ID + "</td></tr>");
                    resultTable.append(row)
                  })
                }
              });

              return false;
            }
    </script>
  </body>
</html>
